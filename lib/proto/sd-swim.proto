/**
 * Supported message types
 */
enum MessageType {
  JOIN = 0;
  UPDATE_JOIN = 1;
  PING = 2;
  ACK = 3;
  PING_REQ = 4;
}

/**
 * Node states
 */
enum NodeState {
    Alive = 0;
    Suspect = 1;
    Faulty = 2;
}

message Node {
  optional string host = 1;
  optional int32 port = 2;
}

message Member {
  required Node node = 1;
  optional NodeState state = 2 [default = 0];
  optional Node setBy = 3;
}

message Entry {
  required Node owner = 1;
  required string key = 2;
  required string value = 3;
}

/**
 * SD-SWIM message
 */
message Msg {
  optional Node sender = 1;
  optional Node target = 2;
  required MessageType type = 3;
  optional string token = 4;
  repeated Member memberList = 5;
  repeated Entry payload = 6; // To propagate further generic metadata
}
